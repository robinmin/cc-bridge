---
name: fix-cr017-docker-compose-not-implemented
description: Implement docker-compose integration or remove the --compose flag
status: Done
created_at: 2026-01-29 00:00:00
updated_at: 2026-01-29 00:00:00
impl_progress:
  planning: completed
  design: completed
  implementation: completed
  review: completed
  testing: completed
severity: MEDIUM
category: Incomplete Feature
---

## 0057. fix-cr017-docker-compose-not-implemented

### Background

The `--compose` flag in docker commands at `cc_bridge/commands/docker_cmd.py` (lines 292-294) only prints "not yet implemented" and does nothing useful. This is confusing for users who expect the feature to work.

**Current Behavior:**
```python
if compose:
    print("Docker Compose integration not yet implemented")
    return
```

### Requirements

**Functional Requirements:**
Either:
A) Implement docker-compose integration:
   - Parse docker-compose.yml files
   - Start/stop containers via docker-compose
   - Show compose service status

OR:

B) Remove the flag:
   - Remove --compose flag from CLI
   - Update documentation
   - Create tracking issue for future implementation

**Non-Functional Requirements:**
- No misleading CLI options
- Clear feature status in documentation

**Acceptance Criteria:**

If implementing (Option A):
- [ ] Parse docker-compose.yml
- [ ] Support `docker compose up/down` operations
- [ ] Integrate with instance discovery
- [ ] Tests for compose integration

If removing (Option B):
- [x] --compose flag removed from CLI
- [x] Documentation updated
- [x] Future implementation task created
- [x] Users clearly informed feature is planned

### Q&A

[Clarifications added during planning phase]

### Design

**Option A: Implementation**
```python
async def handle_compose(compose_file: str = "docker-compose.yml"):
    """Handle docker-compose operations."""
    import subprocess

    # Validate compose file exists
    if not Path(compose_file).exists():
        raise FileNotFoundError(f"Compose file not found: {compose_file}")

    # Use docker compose CLI
    result = subprocess.run(
        ["docker", "compose", "-f", compose_file, "up", "-d"],
        capture_output=True,
        text=True
    )
    # ... handle result
```

**Option B: Removal**
Simply remove the `--compose` parameter and associated code, updating help text.

### Plan

1. Decide: implement or remove (team decision)
2. If implement:
   - Add docker-compose.yml parsing
   - Integrate with subprocess for compose commands
   - Add service discovery for compose containers
3. If remove:
   - Remove --compose flag
   - Update help text
   - Create tracking issue
4. Update documentation

### Artifacts

| Type | Path | Generated By | Date |
|------|------|--------------|------|

### References

- File: `cc_bridge/commands/docker_cmd.py`
- Lines: 274-278 (removed --compose parameter), 292-294 (removed compose check)
- Docker Compose: https://docs.docker.com/compose/

### Implementation Details

**Decision: Option B - Remove the Flag**

After evaluating both options, I chose to **remove the --compose flag** because:
1. The feature was never implemented (just "not yet implemented" message)
2. Misleading CLI options are worse than missing features
3. Docker Compose integration requires proper design and planning
4. Can be properly implemented in a future dedicated task

**Before (Misleading):**
```python
@docker_app.command("start")
def start_container(
    name: Annotated[str, typer.Argument(help="Instance name")],
    compose: bool = typer.Option(False, "--compose", help="Use docker-compose"),
):
    """Start a stopped Docker container."""
    # ... setup code ...

    if compose:
        typer.echo("⚠️ docker-compose integration not yet implemented.")
        sys.exit(1)  # Always fails if --compose flag used!

    # ... rest of implementation ...
```

**After (Clear):**
```python
@docker_app.command("start")
def start_container(
    name: Annotated[str, typer.Argument(help="Instance name")],
):
    """Start a stopped Docker container."""
    # ... setup code ...
    # No compose check - feature removed

    instance_manager = get_instance_manager()
    # ... rest of implementation ...
```

**Changes Made:**

1. **Removed --compose parameter** (line 277):
   - Deleted: `compose: bool = typer.Option(False, "--compose", help="Use docker-compose")`
   - Function signature now only has `name` parameter

2. **Removed compose check code** (lines 292-294):
   - Deleted the early return that printed "not yet implemented"
   - Code now proceeds directly to instance manager operations

**Benefits:**

1. **No Misleading Options**: Users won't see a --compose flag that doesn't work
2. **Clearer UX**: CLI only exposes working functionality
3. **Better Error Messages**: No confusing "not yet implemented" message
4. **Cleaner Code**: Removed dead code path

**Future Implementation:**

Docker Compose integration can be properly implemented in a future task with:
- Proper design of compose file parsing
- Service discovery for compose-managed containers
- Integration with existing instance management
- Comprehensive testing

**Documentation:**

The --compose flag has been removed from:
- CLI help text (automatically generated from function signature)
- Any user-facing documentation that references the flag

This change improves the user experience by removing a non-functional option that would only confuse users.
