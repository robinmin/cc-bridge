# =============================================================================
# CC-Bridge Gateway Server Environment Configuration
# =============================================================================
# Copy this file to .env and fill in your values
#
# This file contains ONLY environment variables used by the Gateway server.
# For Agent/Container configuration, see src/dockers/.env.example
#
# Configuration priority:
# 1. Environment variables (this file)
# 2. JSONC config file (data/config/gateway.jsonc)
# 3. Default values in code
# =============================================================================

# -----------------------------------------------------------------------------
# REQUIRED: Telegram Bot Configuration
# -----------------------------------------------------------------------------

# Your Telegram bot token from @BotFather
# Get it by messaging @BotFather on Telegram and using /newbot
# Example: 123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11
TELEGRAM_BOT_TOKEN=your_telegram_bot_token_here

# -----------------------------------------------------------------------------
# OPTIONAL: Feishu/Lark Bot Configuration
# -----------------------------------------------------------------------------

# Feishu App ID from Feishu Open Platform (https://open.feishu.cn/app)
# Example: cli_xxxxxxxxxxxxx
#FEISHU_APP_ID=your_feishu_app_id_here

# Feishu App Secret from Feishu Open Platform
#FEISHU_APP_SECRET=your_feishu_app_secret_here

# Feishu Domain: feishu (China) or lark (International)
# Default: feishu
#FEISHU_DOMAIN=feishu

# Optional: Feishu Encrypt Key for webhook verification
#FEISHU_ENCRYPT_KEY=your_encrypt_key_here

# Optional: Feishu Verification Token for webhook verification
#FEISHU_VERIFICATION_TOKEN=your_verification_token_here

# -----------------------------------------------------------------------------
# Server Configuration
# -----------------------------------------------------------------------------

# Port for the gateway HTTP server
# Default: 8080 (can also be set in data/config/gateway.jsonc)
#PORT=8080

# Node environment (development | production | test)
# Default: development
NODE_ENV=development

# Gateway server URL (used for diagnostics and health checks)
# Default: http://localhost:8080
#CC_BRIDGE_SERVER_URL=http://localhost:8080

# -----------------------------------------------------------------------------
# Logging Configuration
# -----------------------------------------------------------------------------

# Log level: trace | debug | info | warn | error | fatal
# Default: debug (can also be set in data/config/gateway.jsonc)
LOG_LEVEL=debug

# Log format: json | text
# Default: json (production), text (development)
# Note: Can also be set in data/config/gateway.jsonc
LOG_FORMAT=text

# Service name for structured logging
# Default: gateway
#SERVICE_NAME=gateway

# -----------------------------------------------------------------------------
# Workspace & Projects Configuration
# -----------------------------------------------------------------------------

# Root directory containing all project workspaces
# Default: ~/xprojects (can also be set in data/config/gateway.jsonc)
#PROJECTS_ROOT=/Users/yourname/xprojects

# Alternative to PROJECTS_ROOT (legacy naming)
# Default: ~/xprojects
#PROJECTS_ROOT=/Users/yourname/xprojects

# Workspace root directory (parent of current workspace)
# Default: .. (relative to gateway, can also be set in data/config/gateway.jsonc)
#WORKSPACE_ROOT=/Users/yourname/xprojects

# -----------------------------------------------------------------------------
# IPC (Inter-Process Communication) Configuration
# -----------------------------------------------------------------------------

# Base directory for IPC file-based communication (stop hook callbacks)
# Default: /ipc
#IPC_BASE_DIR=/ipc

# -----------------------------------------------------------------------------
# Services Configuration
# -----------------------------------------------------------------------------

# Enable tmux-based async execution mode
# When enabled, long-running operations use persistent tmux sessions
# Default: false
#ENABLE_TMUX=true

# Enable automatic file cleanup for IPC response files
# Default: true
#FILE_CLEANUP_ENABLED=true

# Whitelist IPs to bypass rate limiting (comma-separated)
# Example: 127.0.0.1,192.168.1.100
#WHITELISTED_IPS=127.0.0.1

# -----------------------------------------------------------------------------
# Security Configuration
# -----------------------------------------------------------------------------

# API key for health endpoint authentication
# If set, /health endpoint requires X-API-Key header or api_key query parameter
# Recommended for production deployments
# Generate a secure random key: openssl rand -hex 32
#HEALTH_API_KEY=your_secure_random_key_here

# -----------------------------------------------------------------------------
# Development & Testing
# -----------------------------------------------------------------------------

# Test IPC directory (for testing only)
# Default: ./data/test-ipc
#TEST_IPC_DIR=./data/test-ipc

# =============================================================================
# Notes
# =============================================================================
#
# 1. Required Variables:
#    - TELEGRAM_BOT_TOKEN (for Telegram bot integration)
#    - FEISHU_APP_ID + FEISHU_APP_SECRET (for Feishu/Lark bot integration, optional)
#
# 2. Configuration Files:
#    - data/config/gateway.jsonc: JSONC config with port, logLevel, etc.
#    - .env: Environment variables (this file)
#    - Environment variables take precedence over JSONC config
#
# 3. Agent Configuration:
#    - For Agent/Container environment variables, see src/dockers/.env.example
#    - Agent variables include: ANTHROPIC_AUTH_TOKEN, AGENT_MODE, etc.
#
# 4. IPC Communication:
#    - Gateway auto-detects IPC method based on container environment
#    - TCP mode (fastest): ~10ms latency
#    - Docker exec (fallback): ~50s latency
#
# 5. Logging:
#    - Use LOG_FORMAT=json for production (structured logs)
#    - Use LOG_FORMAT=text for development (better readability)
#    - Custom HTTP logging format: [METHOD] /path â†’ status (duration)ms
#
# 6. Quick Start:
#    1. Copy this file: cp .env.example .env
#    2. Edit with your Telegram token: nano .env
#    3. Copy container config: cp src/dockers/.env.example src/dockers/.env
#    4. Edit container config with Anthropic token: nano src/dockers/.env
#    5. Start services: make gateway-start && make docker-start
#    6. Check status: curl http://localhost:8080/health
#
# =============================================================================
